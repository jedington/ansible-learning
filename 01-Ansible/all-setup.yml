# store in controller host '~/<this file>'

- name: "Install inventory mapping and setup all remote nodes"
  hosts: all
  become: true # newer ansible version of 'sudo'
  gather_facts: no
  pre_tasks:
  - name: Add Ansible inventory mappings to /etc/hosts
    blockinfile:
      path: /etc/hosts
      block: |
        {% for host in groups['all'] %}
        {{ hostvars[host].ansible_host }} {{ host }}
        {% endfor %}
  - name: install python
    raw: 'cat < ~/python-remote-setup.sh'
    args:
      executable: '/bin/bash'

- name: "Install and setup dev environments"
  hosts: devs
  become: true # newer ansible version of 'sudo'
  vars:
    group: 'devs'
  tasks:
    - name: "install git"
      apt:
        name: git
        state: latest
    - name: "install vim"
      apt:
        name: vim
        state: latest
    - name: "setup dev folder"
      file:
        path: '/{{ group }}'
        state: directory
    - name: "add dev group"
      group:
        name: '{{ group }}'
        state: present

- name: "Install and setup node environments"
  hosts: nodes
  vars:
    home: '/home/vagrant' # can change depending on hierarchy pref
    images: '/home/vagrant/images' # can change depending on hierarchy pref
  tasks:
    - name: "find the files in home directory"
      shell: 'ls -lah {{ home }}'
    - name: "create a file in home directory"
      file:
        path: '{{ home }}/awesome.txt'
        state: touch
    - name: "create the picture folder"
      file:
        path: '{{ images }}'
        state: directory